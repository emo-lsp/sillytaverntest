<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
<title>苍玄开场界面</title>
</head>
<body>
<div id="openingRoot" style="max-width: 650px; margin: 30px auto; background: linear-gradient(145deg, #f0f8ff 0%, #e8f4ff 50%, #deeeff 100%); border-radius: 20px; box-shadow: 0 15px 35px rgba(70, 130, 180, 0.2), 0 5px 15px rgba(0,0,0,0.1); font-family: 'Microsoft YaHei', 'SimHei', serif; color: #2c4166; overflow: hidden; border: 3px solid #87ceeb; position: relative;">

    <div style="background: linear-gradient(90deg, #87ceeb, #add8e6, #87ceeb); padding: 20px; text-align: center; border-bottom: 2px solid #4682b4;">
        <div style="display: inline-block; background: rgba(255,255,255,0.9); padding: 12px 30px; border-radius: 15px; border: 2px solid #5f9ea0; box-shadow: 0 3px 8px rgba(0,0,0,0.1);">
            <div style="font-size: 1.1em; color: #2f4f4f; font-weight: bold; margin-bottom: 5px;">💬 LSP的Discord交流社区</div>
            <div style="font-size: 1.2em; color: #4682b4; font-weight: bold; letter-spacing: 1px;">
                <a href="https://discord.gg/x3aKHgfE3u" style="color: #4682b4; text-decoration: none; transition: all 0.3s;" onmouseover="this.style.textDecoration='underline'; this.style.color='#1e90ff'" onmouseout="this.style.textDecoration='none'; this.style.color='#4682b4'">加入服务器 →</a>
            </div>
        </div>
    </div>

    <div style="background: linear-gradient(90deg, #dda0dd, #e6e6fa, #dda0dd); height: 8px; position: relative;">
        <div style="position: absolute; top: -2px; left: 20px; color: #9370db; font-size: 12px;">☯</div>
        <div style="position: absolute; top: -2px; right: 20px; color: #9370db; font-size: 12px;">⚔️</div>
    </div>

    <div style="padding: 35px;">

        <div style="background: rgba(255,255,255,0.6); padding: 20px; border-radius: 12px; margin-bottom: 30px; border: 1px solid rgba(212,196,176,0.8); text-align: center;">
            <div style="font-size: 0.9em; color: #6a5a3f; line-height: 1.8;">
                <p style="margin: 0 0 12px;"><strong>📜 版权声明</strong><br>这张角色卡是免费的，永远禁止商业化行为。如果你是购买获得，请立即退款并向购买平台举报贩卖者，维护创作者和您自身的权益。</p>
                <p style="margin: 0 0 12px;"><strong>🔒 转载声明</strong><br>未经作者明确授权，严禁将本作品转载至其他任何平台。</p>
                <p style="margin: 0; color: #8b7355; font-style: italic;">—— 作者：emo的lsp ——</p>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(230,230,250,0.5) 0%, rgba(248,248,255,0.7) 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(147, 112, 219, 0.5); position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
            <div style="position: absolute; top: -10px; left: 20px; background: #f0f8ff; padding: 5px 15px; border-radius: 10px; border: 2px solid #9370db; color: #4b0082; font-weight: bold; font-size: 0.9em;">
                ⚠️ 重要提醒
            </div>

            <div style="margin-top: 15px; font-size: 1em; line-height: 1.8; color: #2c4166;">
                <div style="display: flex; align-items: center; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 8px; border-left: 4px solid #8b008b;">
                    <span style="font-size: 1.2em; margin-right: 10px;">⚔️</span>
                    <span style="font-weight: bold; color: #4b0082;">为确保正常体验这个玄幻仙侠世界，您需要：</span>
                </div>

                <div style="display: flex; align-items: center; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 8px; border-left: 4px solid #9370db;">
                    <span style="font-size: 1.2em; margin-right: 10px;">🎭</span>
                    <span style="color: #2c4166;">您需要安装酒馆助手并启用</span>
                </div>

                <div style="display: flex; align-items: center; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 8px; border-left: 4px solid #ff85c1;">
                    <span style="font-size: 1.2em; margin-right: 10px;">📝</span>
                    <span style="color: #5d3a47;">您需要安装提示词模板并启用</span>
                </div>

                <div style="display: flex; align-items: center; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 8px; border-left: 4px solid #ba55d3;">
                    <span style="font-size: 1.2em; margin-right: 10px;">⚙️</span>
                    <span style="color: #2c4166;">您需要开启局部正则，并启用 酒馆助手 - 脚本库 - 底部角色脚本库的所有脚本</span>
                </div>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(255,255,255,0.85) 0%, rgba(248,248,255,0.7) 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(135, 206, 235, 0.4); position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
            <div style="position: absolute; top: -10px; left: 20px; background: #f0f8ff; padding: 5px 15px; border-radius: 10px; border: 2px solid #87ceeb; color: #4682b4; font-weight: bold; font-size: 0.9em;">
                ⚔️ 故事缘起
            </div>

            <div style="margin-top: 15px; font-size: 1.1em; line-height: 1.9; color: #2c4166;">
                <p style="margin-bottom: 18px; text-indent: 2em;">玄幻仙侠世界，修真九境，正魔对立。一个被判定为废物的外门杂役，却隐藏着震古烁今的秘密。</p>

                <p style="margin-bottom: 18px; text-indent: 2em;">孤儿<span style="color: #4682b4; font-weight: bold; background: rgba(135,206,235,0.3); padding: 2px 6px; border-radius: 4px;">{{user}}</span>在宗门测试中被判定无法修炼，成为凌霄宗最底层的杂役。然而无人知晓，他拥有着修真界第一特殊体质——<span style="color: #8b008b; font-weight: bold; background: rgba(147,112,219,0.3); padding: 2px 6px; border-radius: 4px;">荒古肾体</span>。</p>

                <p style="margin-bottom: 18px; text-indent: 2em;">这种体质的效果惊世骇俗：与任意修为的女性双修一次，男女双方均可获得两人综合后十年苦修的修为提升，若处于瓶颈期更是能够水到渠成般突破...</p>

                <p style="margin-bottom: 0; text-indent: 2em; font-style: italic; color: #6b4c8a;">当清冷的宗主、妖媚的魔女、温柔的圣女、同为废体的青梅竹马...四位女子的命运与他交织，这个废物杂役的崛起之路，将掀起怎样的风云？</p>
            </div>
            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 20px; padding-top: 18px; border-top: 1px dashed rgba(135,206,235,0.5);">
                <span style="background: linear-gradient(45deg, #e6e6fa, #f0e6ff); color: #8b008b; padding: 8px 16px; border-radius: 20px; font-size: 0.9em; border: 2px solid #ba55d3; font-weight: bold;">荒古肾体</span>
                <span style="background: linear-gradient(45deg, #e0f2ff, #f0f8ff); color: #4682b4; padding: 8px 16px; border-radius: 20px; font-size: 0.9em; border: 2px solid #87ceeb; font-weight: bold;">雌竞争夺</span>
                <span style="background: linear-gradient(45deg, #ffe6f0, #fff0f8); color: #dc143c; padding: 8px 16px; border-radius: 20px; font-size: 0.9em; border: 2px solid #ffb6c1; font-weight: bold;">双修突破</span>
                <span style="background: linear-gradient(45deg, #e6ffe6, #f0fff0); color: #228b22; padding: 8px 16px; border-radius: 20px; font-size: 0.9em; border: 2px solid #90ee90; font-weight: bold;">废柴崛起</span>
                <span style="background: linear-gradient(45deg, #fff0e6, #fff8f0); color: #b8860b; padding: 8px 16px; border-radius: 20px; font-size: 0.9em; border: 2px solid #daa520; font-weight: bold;">正魔对立</span>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(230,230,250,0.15) 0%, rgba(176,224,230,0.15) 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(147,112,219,0.3); position: relative;">
            <div style="position: absolute; top: -10px; left: 20px; background: #f0f8ff; padding: 5px 15px; border-radius: 10px; border: 2px solid #9370db; color: #4b0082; font-weight: bold; font-size: 0.9em;">
                🎨 女主形象
            </div>

            <div style="margin-top: 20px;">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;" id="heroineGrid">

                    <div class="heroine-card" data-name="虞清寒" data-default-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E5%AE%97%E4%B8%BB%E8%99%9E%E6%B8%85%E5%AF%92/%E8%99%9E%E6%B8%85%E5%AF%92%E5%BE%AE%E7%AC%91%E7%9A%84%E8%A1%A8%E6%83%85/15.jpg" data-alt-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/NSFW/%E5%AE%97%E4%B8%BB%E8%99%9E%E6%B8%85%E5%AF%92/%E8%99%9E%E6%B8%85%E5%AF%92%E4%B8%BAuser%E8%B6%B3%E4%BA%A4/15.jpg" style="background: rgba(255,255,255,0.8); border-radius: 12px; overflow: hidden; border: 2px solid #87ceeb; box-shadow: 0 4px 12px rgba(70,130,180,0.15); cursor: pointer;">
                        <div class="heroine-photo-wrap" style="width: 100%; height: 400px; overflow: hidden; position: relative; border-bottom: 2px solid #87ceeb;">
                            <img class="heroine-photo" src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E5%AE%97%E4%B8%BB%E8%99%9E%E6%B8%85%E5%AF%92/%E8%99%9E%E6%B8%85%E5%AF%92%E5%BE%AE%E7%AC%91%E7%9A%84%E8%A1%A8%E6%83%85/15.jpg" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                            <span class="heroine-tag" style="position:absolute;right:10px;top:10px;background:rgba(70,130,180,0.85);color:#fff;padding:3px 8px;border-radius:999px;font-size:12px;">默认</span>
                            <div class="heroine-spinner"></div>
                        </div>
                        <div style="padding: 15px; text-align: center;">
                            <h4 style="margin: 0 0 8px; color: #4682b4; font-size: 1.1em;">❄️ 虞清寒</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.5;">凌霄宗主·合体后期<br>冰山美人·飞霜仙体</p>
                        </div>
                    </div>

                    <div class="heroine-card" data-name="殷妙烟" data-default-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E9%AD%94%E9%97%A8%E6%AE%B7%E5%A6%99%E7%83%9F/%E6%AE%B7%E5%A6%99%E7%83%9F%E9%AD%85%E6%83%91%E5%9C%B0%E5%BE%AE%E7%AC%91/5.jpg" data-alt-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/NSFW/%E9%AD%94%E9%97%A8%E6%AE%B7%E5%A6%99%E7%83%9F/%E6%AE%B7%E5%A6%99%E7%83%9F%E5%8F%8D%E5%90%91%E7%81%AB%E8%BD%A6%E4%BE%BF%E5%BD%93%E4%BD%93%E4%BD%8D%E6%80%A7%E7%88%B1/7.jpg" style="background: rgba(255,255,255,0.8); border-radius: 12px; overflow: hidden; border: 2px solid #ba55d3; box-shadow: 0 4px 12px rgba(186,85,211,0.15); cursor: pointer;">
                        <div class="heroine-photo-wrap" style="width: 100%; height: 400px; overflow: hidden; position: relative; border-bottom: 2px solid #ba55d3;">
                            <img class="heroine-photo" src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E9%AD%94%E9%97%A8%E6%AE%B7%E5%A6%99%E7%83%9F/%E6%AE%B7%E5%A6%99%E7%83%9F%E9%AD%85%E6%83%91%E5%9C%B0%E5%BE%AE%E7%AC%91/5.jpg" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                            <span class="heroine-tag" style="position:absolute;right:10px;top:10px;background:rgba(138,43,226,0.85);color:#fff;padding:3px 8px;border-radius:999px;font-size:12px;">默认</span>
                            <div class="heroine-spinner"></div>
                        </div>
                        <div style="padding: 15px; text-align: center;">
                            <h4 style="margin: 0 0 8px; color: #8b008b; font-size: 1.1em;">🔥 殷妙烟</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.5;">魔门太上·合体前期<br>妖媚魔女·天魔魅体</p>
                        </div>
                    </div>

                    <div class="heroine-card" data-name="秦素霜" data-default-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E5%9C%A3%E5%A5%B3%E7%A7%A6%E7%B4%A0%E9%9C%9C/%E7%A7%A6%E7%B4%A0%E9%9C%9C%E5%BE%AE%E7%AC%91%E7%9A%84%E8%A1%A8%E6%83%85/5.jpg" data-alt-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/NSFW/%E5%9C%A3%E5%A5%B3%E7%A7%A6%E7%B4%A0%E9%9C%9C/%E7%A7%A6%E7%B4%A0%E9%9C%9C%E4%B8%BAuser%E4%B9%B3%E4%BA%A4/9.jpg" style="background: rgba(255,255,255,0.8); border-radius: 12px; overflow: hidden; border: 2px solid #90ee90; box-shadow: 0 4px 12px rgba(144,238,144,0.15); cursor: pointer;">
                        <div class="heroine-photo-wrap" style="width: 100%; height: 400px; overflow: hidden; position: relative; border-bottom: 2px solid #90ee90;">
                            <img class="heroine-photo" src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E5%9C%A3%E5%A5%B3%E7%A7%A6%E7%B4%A0%E9%9C%9C/%E7%A7%A6%E7%B4%A0%E9%9C%9C%E5%BE%AE%E7%AC%91%E7%9A%84%E8%A1%A8%E6%83%85/5.jpg" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                            <span class="heroine-tag" style="position:absolute;right:10px;top:10px;background:rgba(46,139,87,0.85);color:#fff;padding:3px 8px;border-radius:999px;font-size:12px;">默认</span>
                            <div class="heroine-spinner"></div>
                        </div>
                        <div style="padding: 15px; text-align: center;">
                            <h4 style="margin: 0 0 8px; color: #228b22; font-size: 1.1em;">🌿 秦素霜</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.5;">百花谷圣女·化神中期<br>温柔圣手·医仙圣体</p>
                        </div>
                    </div>

                    <div class="heroine-card" data-name="江小鲤" data-default-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E9%9D%92%E6%A2%85%E6%B1%9F%E5%B0%8F%E9%B2%A4/%E6%B2%A1%E5%BC%80%E5%A7%8B%E4%BF%AE%E7%82%BC%E7%9A%84%E6%B1%9F%E5%B0%8F%E9%B2%A4%E5%9C%A8%E5%B9%B2%E6%B4%BB/9.jpg" data-alt-src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/NSFW/%E9%9D%92%E6%A2%85%E6%B1%9F%E5%B0%8F%E9%B2%A4/user%E8%88%94%E8%88%90%E8%BF%98%E6%B2%A1%E5%BC%80%E5%A7%8B%E4%BF%AE%E7%82%BC%E7%9A%84%E6%B1%9F%E5%B0%8F%E9%B2%A4%E7%9A%84%E7%8E%89%E8%B6%B3/8.jpg" style="background: rgba(255,255,255,0.8); border-radius: 12px; overflow: hidden; border: 2px solid #ffb6c1; box-shadow: 0 4px 12px rgba(255,182,193,0.15); cursor: pointer;">
                        <div class="heroine-photo-wrap" style="width: 100%; height: 400px; overflow: hidden; position: relative; border-bottom: 2px solid #ffb6c1;">
                            <img class="heroine-photo" src="https://gitgud.io/opus5/xiuxian/-/raw/master/CG/SFW/%E9%9D%92%E6%A2%85%E6%B1%9F%E5%B0%8F%E9%B2%A4/%E6%B2%A1%E5%BC%80%E5%A7%8B%E4%BF%AE%E7%82%BC%E7%9A%84%E6%B1%9F%E5%B0%8F%E9%B2%A4%E5%9C%A8%E5%B9%B2%E6%B4%BB/9.jpg" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                            <span class="heroine-tag" style="position:absolute;right:10px;top:10px;background:rgba(220,20,60,0.85);color:#fff;padding:3px 8px;border-radius:999px;font-size:12px;">默认</span>
                            <div class="heroine-spinner"></div>
                        </div>
                        <div style="padding: 15px; text-align: center;">
                            <h4 style="margin: 0 0 8px; color: #dc143c; font-size: 1.1em;">🌸 江小鲤</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.5;">外门杂役·无修为<br>青梅竹马·同为废体</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div style="margin-bottom: 30px;">
            <h3 style="color: #4b0082; margin-bottom: 20px; font-size: 1.3em; text-align: center; position: relative;">
                <span style="background: #f0f8ff; padding: 8px 20px; border: 2px solid #9370db; border-radius: 25px;">🌟 核心角色</span>
            </h3>

            <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 15px; align-items: center; background: rgba(255,255,255,0.6); padding: 25px; border-radius: 12px; border: 1px solid rgba(147,112,219,0.5); margin-bottom: 20px;">

                <div style="text-align: center; background: rgba(176,224,230,0.15); padding: 20px; border-radius: 10px; border: 2px solid rgba(70,130,180,0.3);">
                    <div style="font-size: 2.5em; margin-bottom: 8px;">⚔️</div>
                    <h4 style="color: #4682b4; margin: 0 0 8px; font-size: 1.1em; font-weight: bold;">{{user}}</h4>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">荒古肾体拥有者<br>外门杂役·隐藏体质</p>
                </div>

                <div style="text-align: center; color: #8b008b; font-size: 1.5em;">
                    ⟷<br>
                    <span style="font-size: 0.6em; color: #6b4c8a;">命运纠葛</span>
                </div>

                <div style="text-align: center; background: rgba(221,160,221,0.15); padding: 20px; border-radius: 10px; border: 2px solid rgba(147,112,219,0.3);">
                    <div style="font-size: 2.5em; margin-bottom: 8px;">👥</div>
                    <h4 style="color: #8b008b; margin: 0 0 8px; font-size: 1.1em; font-weight: bold;">四位女主</h4>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">各怀心思<br>命运交织</p>
                </div>
            </div>

            <div style="background: rgba(147,112,219,0.12); padding: 20px; border-radius: 12px; border: 2px solid rgba(147,112,219,0.3); margin-bottom: 15px; text-align: center;">
                <div style="font-size: 2.2em; margin-bottom: 8px;">🌟</div>
                <h4 style="color: #4b0082; margin: 0 0 8px; font-size: 1.1em; font-weight: bold;">特殊体质·荒古肾体</h4>
                <p style="margin: 0; font-size: 0.95em; color: #2c4166; line-height: 1.5;">
                    <strong>效果：</strong>与任意女修双修，双方获得十年苦修修为<br>
                    <strong>限制：</strong>每日仅对一人生效，可自主控制开启<br>
                    <strong>特殊：</strong>瓶颈期可直接突破，无需渡劫
                </p>
                <p style="margin: 10px 0 0; font-size: 0.85em; color: #6b4c8a; font-style: italic;">
                    "这个秘密一旦暴露，将引起整个修真界的腥风血雨..."
                </p>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(240,248,255,0.3) 0%, rgba(230,230,250,0.4) 100%); padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 1px solid rgba(135,206,235,0.4);">
            <h4 style="color: #4682b4; margin-top: 0; margin-bottom: 15px; font-size: 1.1em; text-align: center;">
                <span style="background: #f0f8ff; padding: 5px 15px; border: 1px solid #87ceeb; border-radius: 15px;">🏔️ 重要配角</span>
            </h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                <div style="background: rgba(255,255,255,0.8); padding: 12px; border-radius: 8px; border-left: 3px solid #9370db;">
                    <h5 style="color: #8b008b; margin: 0 0 5px; font-size: 0.9em;">🧚 洛筱筱·八卦精</h5>
                    <p style="margin: 0; font-size: 0.85em; color: #2c4166; line-height: 1.4;">外门弟子，到处传播消息的小迷妹</p>
                </div>
                <div style="background: rgba(255,255,255,0.8); padding: 12px; border-radius: 8px; border-left: 3px solid #ba55d3;">
                    <h5 style="color: #9932cc; margin: 0 0 5px; font-size: 0.9em;">💋 花念卿·风骚长老</h5>
                    <p style="margin: 0; font-size: 0.85em; color: #2c4166; line-height: 1.4;">百花谷长老，秦素霜的师叔</p>
                </div>
                <div style="background: rgba(255,255,255,0.8); padding: 12px; border-radius: 8px; border-left: 3px solid #4682b4;">
                    <h5 style="color: #1e90ff; margin: 0 0 5px; font-size: 0.9em;">⚔️ 陈破军·铁憨憨</h5>
                    <p style="margin: 0; font-size: 0.85em; color: #2c4166; line-height: 1.4;">执法堂成员，虞清寒的追求者</p>
                </div>
                <div style="background: rgba(255,255,255,0.8); padding: 12px; border-radius: 8px; border-left: 3px solid #708090;">
                    <h5 style="color: #2f4f4f; margin: 0 0 5px; font-size: 0.9em;">🎭 萧寒烟·老阴逼</h5>
                    <p style="margin: 0; font-size: 0.85em; color: #2c4166; line-height: 1.4;">太上长老，暗中推动一切</p>
                </div>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(230,230,250,0.12) 0%, rgba(176,224,230,0.12) 100%); padding: 25px; border-radius: 12px; margin-bottom: 25px; border: 1px solid rgba(147,112,219,0.4);">
            <h3 style="color: #4b0082; margin-top: 0; margin-bottom: 18px; font-size: 1.2em; display: flex; align-items: center;">
                <span style="margin-right: 10px;">🏔️</span> 修真境界
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                <div style="background: rgba(255,255,255,0.7); padding: 15px; border-radius: 8px; border-left: 3px solid #87ceeb;">
                    <h5 style="color: #4682b4; margin: 0 0 8px; font-size: 0.95em;">🌟 凡尘筑基</h5>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">炼气·筑基·金丹<br>脱凡入道之始</p>
                </div>
                <div style="background: rgba(255,255,255,0.7); padding: 15px; border-radius: 8px; border-left: 3px solid #9370db;">
                    <h5 style="color: #8b008b; margin: 0 0 8px; font-size: 0.95em;">⚡ 超凡入圣</h5>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">元婴·化神·炼虚<br>掌控天地法则</p>
                </div>
                <div style="background: rgba(255,255,255,0.7); padding: 15px; border-radius: 8px; border-left: 3px solid #daa520;">
                    <h5 style="color: #b8860b; margin: 0 0 8px; font-size: 0.95em;">☯ 合道不朽</h5>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">合体·大乘·渡劫<br>追求永恒超脱</p>
                </div>
                <div style="background: rgba(255,255,255,0.7); padding: 15px; border-radius: 8px; border-left: 3px solid #dc143c;">
                    <h5 style="color: #8b0000; margin: 0 0 8px; font-size: 0.95em;">🌌 飞升成仙</h5>
                    <p style="margin: 0; font-size: 0.9em; color: #2c4166; line-height: 1.4;">真仙之境<br>与天地同寿</p>
                </div>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, rgba(230,230,250,0.6) 0%, rgba(248,248,255,0.8) 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(147,112,219,0.5); position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
            <div style="position: absolute; top: -10px; left: 20px; background: #f0f8ff; padding: 5px 15px; border-radius: 10px; border: 2px solid #9370db; color: #8b008b; font-weight: bold; font-size: 0.9em;">
                📖 五个开场
            </div>
            <div class="opening-grid" style="margin-top: 20px;">
                <div class="opening-card">
                    <div class="opening-badge">开场 1</div>
                    <div class="opening-title">青梅江小鲤线</div>
                    <div class="opening-desc">从外门杂役与青梅竹马的日常开始，命运暗潮初现。</div>
                </div>
                <div class="opening-card">
                    <div class="opening-badge">开场 2</div>
                    <div class="opening-title">宗主虞清寒线</div>
                    <div class="opening-desc">以宗主线开局，清冷高位与禁忌吸引并行推进。</div>
                </div>
                <div class="opening-card">
                    <div class="opening-badge">开场 3</div>
                    <div class="opening-title">魔门殷妙烟线</div>
                    <div class="opening-desc">魔门试探先至，危险与诱惑在暗处先一步降临。</div>
                </div>
                <div class="opening-card">
                    <div class="opening-badge">开场 4</div>
                    <div class="opening-title">圣女秦素霜线</div>
                    <div class="opening-desc">圣女医道线展开，温柔表象下藏着更深的牵引。</div>
                </div>
                <div class="opening-card">
                    <div class="opening-badge">开场 5</div>
                    <div class="opening-title">四女齐聚线</div>
                    <div class="opening-desc">多线同启，雌竞格局直接拉满，冲突与机缘并发。</div>
                </div>
            </div>
        </div>

    </div>

</div>
<style>
.heroine-card {
    position: relative;
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}
.heroine-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 22px rgba(70,130,180,0.22) !important;
    border-color: #4aa3d8 !important;
}
.heroine-card:active {
    transform: translateY(-1px) scale(0.99);
}
.heroine-card .heroine-photo-wrap {
    position: relative;
    background: #eef2f7;
}
.heroine-card .heroine-photo-wrap::after {
    content: '点击切换差分';
    position: absolute;
    left: 10px;
    top: 10px;
    background: rgba(32, 53, 81, 0.72);
    color: #f3f7ff;
    border-radius: 999px;
    padding: 3px 9px;
    font-size: 12px;
    letter-spacing: 0.2px;
}
.heroine-card.is-alt .heroine-photo-wrap::after {
    content: '点击切回默认';
    background: rgba(126, 47, 161, 0.78);
}
.heroine-card .heroine-photo {
    display: block;
    opacity: 1;
    transition: opacity 0.35s ease;
}
.heroine-card .heroine-photo.fade-out {
    opacity: 0;
}
.heroine-card.is-loading .heroine-photo-wrap::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 2;
    background: rgba(238,242,247,0.6);
    backdrop-filter: blur(2px);
}
.heroine-card.is-loading .heroine-photo-wrap .heroine-spinner {
    display: block;
}
.heroine-spinner {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    z-index: 3;
    width: 32px;
    height: 32px;
    margin: -16px 0 0 -16px;
    border: 3px solid rgba(147,112,219,0.3);
    border-top-color: #9370db;
    border-radius: 50%;
    animation: heroine-spin 0.7s linear infinite;
}
@keyframes heroine-spin {
    to { transform: rotate(360deg); }
}
.heroine-card .heroine-tag {
    transition: all 0.2s ease;
}
.heroine-card.is-alt .heroine-tag {
    background: rgba(139, 0, 139, 0.85) !important;
}
.opening-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 14px;
}
.opening-card {
    background: rgba(255, 255, 255, 0.85);
    border: 1px solid rgba(147,112,219,0.35);
    border-radius: 12px;
    padding: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
}
.opening-card:hover {
    transform: translateY(-2px);
    border-color: #9370db;
    box-shadow: 0 4px 12px rgba(70, 130, 180, 0.15);
}
.opening-card.loading {
    opacity: 0.65;
    pointer-events: none;
}
.opening-badge {
    display: inline-block;
    background: rgba(147,112,219,0.18);
    color: #6b4c8a;
    border: 1px solid rgba(147,112,219,0.35);
    border-radius: 999px;
    padding: 2px 8px;
    font-size: 12px;
    margin-bottom: 6px;
}
.opening-title {
    color: #4b0082;
    font-weight: bold;
    margin-bottom: 6px;
    font-size: 0.98em;
}
.opening-desc {
    color: #2c4166;
    font-size: 0.88em;
    line-height: 1.5;
}
#openingRoot {
    background: linear-gradient(145deg, #f7f3ec 0%, #f4efe6 52%, #efe8dc 100%) !important;
    border: 2px solid #d4c4b0 !important;
    box-shadow: 0 12px 30px rgba(58, 51, 48, 0.14) !important;
    color: #3a3330 !important;
}
#openingRoot::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(150deg, rgba(201,169,97,0.1), transparent 40%, rgba(90,138,126,0.1));
}
#openingRoot > * {
    position: relative;
    z-index: 1;
}
#openingRoot > div:nth-child(1) {
    background: linear-gradient(90deg, rgba(90,138,126,0.22), rgba(74,124,158,0.2), rgba(90,138,126,0.22)) !important;
    border-bottom-color: #b9c8c0 !important;
}
#openingRoot > div:nth-child(2) {
    background: linear-gradient(90deg, rgba(201,169,97,0.35), rgba(212,196,176,0.2), rgba(201,169,97,0.35)) !important;
}
#openingRoot > div:nth-child(3) > div {
    background: rgba(255, 255, 255, 0.5) !important;
    border: 1px solid rgba(212, 196, 176, 0.9) !important;
    box-shadow: 0 8px 20px rgba(58, 51, 48, 0.08) !important;
}
#openingRoot a {
    color: #4a7c9e !important;
}
#openingRoot .opening-badge {
    background: rgba(201,169,97,0.18);
    color: #6a5a3f;
    border-color: rgba(201,169,97,0.35);
}
#openingRoot .opening-title {
    color: #5a8a7e;
}
#openingRoot .opening-card:hover {
    border-color: #c9a961;
    box-shadow: 0 6px 16px rgba(90,138,126,0.22);
}
@media (max-width: 640px) {
    .opening-grid {
        grid-template-columns: 1fr;
    }
    #heroineGrid {
        grid-template-columns: 1fr !important;
    }
    .heroine-card .heroine-photo-wrap {
        height: auto !important;
        aspect-ratio: 3 / 4;
    }
}
</style>
<script>
function preloadImage(src) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        img.onload = () => resolve(src);
        img.onerror = () => reject(new Error('图片加载失败'));
        img.src = src;
    });
}

async function toggleHeroineDiff(card) {
    if (!card || card.classList.contains('is-loading')) return;
    const img = card.querySelector('.heroine-photo');
    const tag = card.querySelector('.heroine-tag');
    if (!img || !tag) return;
    const defaultSrc = card.getAttribute('data-default-src') || img.src;
    const altSrc = card.getAttribute('data-alt-src') || '';
    const isAlt = card.classList.contains('is-alt');
    if (!isAlt && (!altSrc || altSrc.indexOf('__在此替换') === 0)) {
        alert(`请先填写${card.getAttribute('data-name') || '该角色'}的差分图链接（data-alt-src）`);
        return;
    }

    const targetSrc = isAlt ? defaultSrc : altSrc;
    const targetTag = isAlt ? '默认' : '差分';

    card.classList.add('is-loading');
    try {
        await preloadImage(targetSrc);
    } catch (error) {
        card.classList.remove('is-loading');
        console.error(error);
        alert('差分图加载失败，请检查链接是否可访问。');
        return;
    }
    img.classList.add('fade-out');
    await new Promise(r => setTimeout(r, 350));
    img.src = targetSrc;
    card.classList.toggle('is-alt', !isAlt);
    tag.textContent = targetTag;
    card.classList.remove('is-loading');
    img.classList.remove('fade-out');
}

async function switchToOpening(swipeId, clickedCard) {
    if (clickedCard) {
        clickedCard.classList.add('loading');
    }
    try {
        const host = resolveTavernHost();
        if (!host) {
            throw new Error('当前环境未检测到酒馆接口，请在 SillyTavern 中使用。');
        }
        const getMessagesFn = host.getChatMessages;
        const setMessageFn = host.setChatMessage;

        const messages = await getMessagesFn('0', { include_swipe: true });
        if (messages && messages[0] && messages[0].swipes && messages[0].swipes[swipeId]) {
            await setMessageFn(messages[0].swipes[swipeId], 0, {
                swipe_id: swipeId,
                refresh: 'display_and_render_current',
            });
        } else {
            throw new Error(`开场白 ${swipeId} 未找到，请确认 Swipe 已创建。`);
        }
    } catch (error) {
        console.error('切换开场白失败:', error);
        alert(`切换失败: ${error.message}`);
        if (clickedCard) {
            clickedCard.classList.remove('loading');
        }
    }
}

function resolveTavernHost() {
    const candidates = [];
    try { candidates.push(window); } catch (_) {}
    try { if (window.parent && window.parent !== window) candidates.push(window.parent); } catch (_) {}
    try { if (window.top && window.top !== window && window.top !== window.parent) candidates.push(window.top); } catch (_) {}
    for (const host of candidates) {
        if (host && typeof host.getChatMessages === 'function' && typeof host.setChatMessage === 'function') {
            return host;
        }
    }
    return null;
}

function bindInteractionEvents() {
    const heroineCards = document.querySelectorAll('.heroine-card');
    heroineCards.forEach((card) => {
        card.addEventListener('click', () => toggleHeroineDiff(card));
    });

    const openingCards = document.querySelectorAll('.opening-card');
    openingCards.forEach((card, index) => {
        card.addEventListener('click', () => switchToOpening(index + 1, card));
    });
}

window.toggleHeroineDiff = toggleHeroineDiff;
window.switchToOpening = switchToOpening;

setTimeout(function () {
    bindInteractionEvents();
}, 0);
</script>
</body>
</html>
